OpenVPN
=======
*Note: If OpenVPN connections are being blocked in your country, please refer to the 'stunnel-instructions.md' file instead which will help you wrap your OpenVPN traffic in an encrypted tunnel so it looks like standard SSL traffic.*

### A note on client files ###
For security reasons, OpenVPN clients typically have their own unique certificate and private key. The server you are connecting to has been configured to allow clients to share the same certificate and private key, but you may still wish to give your phone and laptop different keys, for example. The client files are located in the client-files subdirectory of the folder containing these instructions. Five unique sets are generated by default.

Most modern clients are able to use OpenVPN profiles (.ovpn files) and you will not need to copy anything else. However, there are some clients that may need you to specify individual files for the certificate, key, tls-auth, etc. These files are also provided in each client folder, just in case.

Windows
-------
1. Download and run the OpenVPN [Windows Installer](https://openvpn.net/index.php/open-source/downloads.html)
2. Click 'Next' and accept the license agreement by clicking 'I Agree'
3. Click 'Next' on the 'Choose Components' screen. Leave all of the default options checked.
4. Make note of the Destination Folder. This is where you will place the client configuration after installation. Click 'Install'.
5. A Windows Security notice will appear and ask 'Would you like to install this device software?'. Click 'Install'.
6. Click 'Next' on the 'Installation Complete' screen
7. Uncheck 'Show Readme' and click 'Finish'
8. Right-click on the OpenVPN GUI desktop icon and choose 'Properties'
9. Go to the 'Compatibility' tab and click the 'Run this program as an administrator' checkbox in the 'Privilege Level' section
10. Double-click the OpenVPN GUI desktop icon to launch the application
11. Open the 'config' directory that is located in the Destination Folder. For most users, this will either be in C:\Program Files\OpenVPN\config or C:\Program Files (x86)\OpenVPN\config. You will see a single README file in this directory.
12. Drag and drop a '{{ openvpn_direct_profile_filename }}' file from one of the client-files folders to this location alongside the README. The client-files folders are located in the same directory as these instructions.
13. Right-click on the OpenVPN icon in your taskbar and choose 'Connect'
14. You will see a log scroll by as the connection is established, followed by a taskbar notification indicating your assigned IP
15. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.

OS X
----
1. Download and open [Tunnelblick](https://code.google.com/p/tunnelblick/). **Mavericks users must install the latest Beta Release at this time.**
2. Click 'Install'
3. Click 'Launch' after the installation is finished
4. Enter your password and click 'OK' if Tunnelblick asks to 'repair ownership/permissions'
5. Click the 'Open configuration folder' button on the 'Welcome to Tunnelblick' screen
6. Drag and drop a '{{ openvpn_direct_profile_filename }}' file from one of the client-files folders to the folder that was opened. The client-files folders are located in the same directory as these instructions. You may need to enter your password in order to authorize Finder to copy the file to this location.
7. Look for the Tunnelblick icon in your menu bar. Click on it, and choose 'Connect'. You will see an animation while the connection is being established. You can also click on the icon and choose 'Details' to see a log of what is happening.
8. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.

Linux
-----
1. Install OpenVPN

   `sudo apt-get install openvpn` OR `sudo yum install openvpn` OR `esoteric-package-manager hipster openvpn`
2. Copy a '{{ openvpn_direct_profile_filename }}' file from one of the client-files folders to the location of your choice. /etc/openvpn/ is a decent option.
3. Execute OpenVPN, and pass it the .ovpn profile as an option.

   `sudo openvpn {{ openvpn_direct_profile_filename }}`
4. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.

Linux (Ubuntu)
--------------
It's preferable to configure Ubuntu using the OpenVPN plugin for NetworkManager. This gives you a nice little interface for connecting, and it properly handles the necessary DNS changes when you connect/disconnect. Unfortunately, the plugin does not support .ovpn profiles, so the list of steps is a little more involved.

1. Install the OpenVPN plugin for NetworkManager

   `sudo apt-get install network-manager-openvpn`
2. Open your System Settings
3. Click the Network icon
4. Click the '+' button in the lower-left of the window
5. Select 'VPN' from the Interface drop-down and click 'Create'
6. Select 'OpenVPN' and click 'Create'
7. Enter '{{ streisand_server_name }}' for the 'Connection name'
8. Enter '{{ openvpn_server }}' for the 'Gateway'
9. Make sure 'Certificates (TLS)' is selected for the 'Type'
10. Select 'client.crt' from the client-files directory of your choice for the 'User Certificate'
11. Select 'ca.crt' from the same client-files directory for the 'CA Certificate'
12. Select 'client.key' from the same client-files directory for the 'Private Key'
13. Click the 'Advanced' button
14. Go to the General tab
    * Check 'Use custom gateway port' and enter '{{ openvpn_port }} as its value
    * Check 'Use LZO data compression'
    * Check 'Use a TCP connection'
16. Go to the Security tab
    * Select '{{ openvpn_cipher }}' as the Cipher
    * Select '{{ openvpn_auth_digest }}' as the HMAC Authentication
17. Go to the TLS Authentication tab
    * Check 'Verify peer (server) certificate usage signature
    * Check 'Use additional TLS authentication'
      * Select 'ta.key' from the client-files directory for the 'Key File'
      * Select '1' as the 'Key Direction'
    * Click 'OK'
18. Click 'Save...'
19. Select the VPN in the left-hand menu, and flip the switch to 'ON'. You can also enable/disable the VPN by clicking on the WiFi/Network icon in the menu bar, scrolling to 'VPN Connections', and clicking on its name.
20. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.

Android
-------
1. Install [OpenVPN for Android](https://play.google.com/store/apps/details?id=de.blinkt.openvpn)
2. Copy a '{{ openvpn_direct_profile_filename }}' file from one of the client-files folders to your phone. The client-files folders are located in the same directory as these instructions.
3. Launch OpenVPN for Android
4. Tap the folder icon in the lower-right of the screen
5. Select the '{{ openvpn_direct_profile_filename }}' profile that you copied to your phone
6. Tap the save icon (floppy disk) in the lower-right of the screen after the import is complete
7. Tap the profile
8. Accept the Android VPN connection warning
9. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.

Firefox for Android has a DNS resolution [bug](https://bugzilla.mozilla.org/show_bug.cgi?id=947801) that affects VPN users who are running Android 4.4. The following workaround ensures that lookups can be performed successfully, even if you remain connected to the OpenVPN server for an extended period of time.

### Configuring Firefox for Android to use the Dante SOCKS server ###
1. Open Firefox
2. Type "about:config" into the address bar and tap the 'Go' button on your keyboard
3. Type "proxy" into the search box
4. Set the value of 'network.proxy.socks' to '10.8.0.1'
5. Set the value of 'network.proxy.socks_port' to '1080'
6. Set the value of 'network.proxy.socks\_remote\_dns' to 'true'
7. Set the value of 'network.proxy.type' to '1'

iOS
---
1. Download [OpenVPN Connect](https://itunes.apple.com/us/app/openvpn-connect/id590379981) and launch it
2. Open iTunes on your computer and connect your phone
3. Select your phone, click on the Apps tab, and find OpenVPN under the File Sharing section
4. Drag and drop a '{{ openvpn_direct_profile_filename }}' file from one of the client-files folders into the file sharing window. The client-files folders are located in the same directory as these instructions.
5. OpenVPN on your phone will say that '1 new OpenVPN profile is available for import.'
6. Tap the green '+' button to import the profile
7. Tap the slider to connect to the OpenVPN server
8. Success! You can verify that your traffic is being routed properly by visiting the Tor Project's check page, [Are you using Tor?](https://check.torproject.org/) It should say 'Your IP address appears to be: {{ streisand_ipv4_address }}'.
